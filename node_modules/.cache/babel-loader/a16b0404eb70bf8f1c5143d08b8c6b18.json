{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport * as React from 'react';\nimport { useControllableValue, useId } from '@fluentui/react-hooks';\nimport { classNamesFunction, css, divProperties, getNativeProps, getRTL, KeyCodes, warn } from '@fluentui/utilities';\nimport { CommandButton } from '../../Button';\nimport { useOverflow } from '../../utilities/useOverflow';\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\nimport { DirectionalHint } from '../ContextualMenu/ContextualMenu.types';\nimport { Icon } from '../Icon/Icon';\nimport { PivotItem } from './PivotItem';\nvar getClassNames = classNamesFunction();\nvar COMPONENT_NAME = 'Pivot';\n\nvar getTabId = function (props, pivotId, itemKey, index) {\n  if (props.getTabId) {\n    return props.getTabId(itemKey, index);\n  }\n\n  return pivotId + (\"-Tab\" + index);\n}; // Gets the set of PivotLinks as array of IPivotItemProps\n// The set of Links is determined by child components of type PivotItem\n\n\nvar getLinkItems = function (props, pivotId) {\n  var result = {\n    links: [],\n    keyToIndexMapping: {},\n    keyToTabIdMapping: {}\n  };\n  React.Children.forEach(React.Children.toArray(props.children), function (child, index) {\n    if (isPivotItem(child)) {\n      // eslint-disable-next-line deprecation/deprecation\n      var _a = child.props,\n          linkText = _a.linkText,\n          pivotItemProps = __rest(_a, [\"linkText\"]);\n\n      var itemKey = child.props.itemKey || index.toString();\n      result.links.push(__assign(__assign({\n        headerText: linkText\n      }, pivotItemProps), {\n        itemKey: itemKey\n      }));\n      result.keyToIndexMapping[itemKey] = index;\n      result.keyToTabIdMapping[itemKey] = getTabId(props, pivotId, itemKey, index);\n    } else if (child) {\n      warn('The children of a Pivot component must be of type PivotItem to be rendered.');\n    }\n  });\n  return result;\n};\n\nvar isPivotItem = function (item) {\n  var _a;\n\n  return React.isValidElement(item) && ((_a = item.type) === null || _a === void 0 ? void 0 : _a.name) === PivotItem.name;\n};\n\nexport var PivotBase = React.forwardRef(function (props, ref) {\n  var focusZoneRef = React.useRef(null);\n  var overflowMenuButtonComponentRef = React.useRef(null);\n  var pivotId = useId('Pivot');\n\n  var _a = useControllableValue(props.selectedKey, props.defaultSelectedKey),\n      selectedKey = _a[0],\n      setSelectedKey = _a[1];\n\n  var componentRef = props.componentRef,\n      theme = props.theme,\n      linkSize = props.linkSize,\n      linkFormat = props.linkFormat,\n      overflowBehavior = props.overflowBehavior,\n      overflowAriaLabel = props.overflowAriaLabel,\n      focusZoneProps = props.focusZoneProps;\n  var classNames;\n  var nameProps = {\n    'aria-label': props['aria-label'],\n    'aria-labelledby': props['aria-labelledby']\n  };\n  var divProps = getNativeProps(props, divProperties, ['aria-label', 'aria-labelledby']);\n  var linkCollection = getLinkItems(props, pivotId);\n  React.useImperativeHandle(componentRef, function () {\n    return {\n      focus: function () {\n        var _a;\n\n        (_a = focusZoneRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      }\n    };\n  });\n\n  var renderLinkContent = function (link) {\n    if (!link) {\n      return null;\n    }\n\n    var itemCount = link.itemCount,\n        itemIcon = link.itemIcon,\n        headerText = link.headerText;\n    return React.createElement(\"span\", {\n      className: classNames.linkContent\n    }, itemIcon !== undefined && React.createElement(\"span\", {\n      className: classNames.icon\n    }, React.createElement(Icon, {\n      iconName: itemIcon\n    })), headerText !== undefined && React.createElement(\"span\", {\n      className: classNames.text\n    }, \" \", link.headerText), itemCount !== undefined && React.createElement(\"span\", {\n      className: classNames.count\n    }, \" (\", itemCount, \")\"));\n  };\n\n  var renderPivotLink = function (renderLinkCollection, link, renderPivotLinkSelectedKey, className) {\n    var itemKey = link.itemKey,\n        headerButtonProps = link.headerButtonProps,\n        onRenderItemLink = link.onRenderItemLink;\n    var tabId = renderLinkCollection.keyToTabIdMapping[itemKey];\n    var linkContent;\n    var isSelected = renderPivotLinkSelectedKey === itemKey;\n\n    if (onRenderItemLink) {\n      linkContent = onRenderItemLink(link, renderLinkContent);\n    } else {\n      linkContent = renderLinkContent(link);\n    }\n\n    var contentString = link.headerText || '';\n    contentString += link.itemCount ? ' (' + link.itemCount + ')' : ''; // Adding space supplementary for icon\n\n    contentString += link.itemIcon ? ' xx' : '';\n    return React.createElement(CommandButton, __assign({}, headerButtonProps, {\n      id: tabId,\n      key: itemKey,\n      className: css(className, isSelected && classNames.linkIsSelected),\n      // eslint-disable-next-line react/jsx-no-bind\n      onClick: function (ev) {\n        return onLinkClick(itemKey, ev);\n      },\n      // eslint-disable-next-line react/jsx-no-bind\n      onKeyDown: function (ev) {\n        return onKeyDown(itemKey, ev);\n      },\n      \"aria-label\": link.ariaLabel,\n      role: link.role || 'tab',\n      \"aria-selected\": isSelected,\n      name: link.headerText,\n      keytipProps: link.keytipProps,\n      \"data-content\": contentString\n    }), linkContent);\n  };\n\n  var onLinkClick = function (itemKey, ev) {\n    ev.preventDefault();\n    updateSelectedItem(itemKey, ev);\n  };\n\n  var onKeyDown = function (itemKey, ev) {\n    // eslint-disable-next-line deprecation/deprecation\n    if (ev.which === KeyCodes.enter) {\n      ev.preventDefault();\n      updateSelectedItem(itemKey);\n    }\n  };\n\n  var updateSelectedItem = function (itemKey, ev) {\n    var _a;\n\n    setSelectedKey(itemKey);\n    linkCollection = getLinkItems(props, pivotId);\n\n    if (props.onLinkClick && linkCollection.keyToIndexMapping[itemKey] >= 0) {\n      var selectedIndex = linkCollection.keyToIndexMapping[itemKey];\n      var item = React.Children.toArray(props.children)[selectedIndex];\n\n      if (isPivotItem(item)) {\n        props.onLinkClick(item, ev);\n      }\n    }\n\n    (_a = overflowMenuButtonComponentRef.current) === null || _a === void 0 ? void 0 : _a.dismissMenu();\n  };\n\n  var renderPivotItem = function (itemKey, isActive) {\n    if (props.headersOnly || !itemKey) {\n      return null;\n    }\n\n    var index = linkCollection.keyToIndexMapping[itemKey];\n    var selectedTabId = linkCollection.keyToTabIdMapping[itemKey];\n    return React.createElement(\"div\", {\n      role: \"tabpanel\",\n      hidden: !isActive,\n      key: itemKey,\n      \"aria-hidden\": !isActive,\n      \"aria-labelledby\": selectedTabId,\n      className: classNames.itemContainer\n    }, React.Children.toArray(props.children)[index]);\n  };\n\n  var isKeyValid = function (itemKey) {\n    return itemKey === null || itemKey !== undefined && linkCollection.keyToIndexMapping[itemKey] !== undefined;\n  };\n\n  var getSelectedKey = function () {\n    if (isKeyValid(selectedKey)) {\n      return selectedKey;\n    }\n\n    if (linkCollection.links.length) {\n      return linkCollection.links[0].itemKey;\n    }\n\n    return undefined;\n  };\n\n  classNames = getClassNames(props.styles, {\n    theme: theme,\n    linkSize: linkSize,\n    linkFormat: linkFormat\n  });\n  var renderedSelectedKey = getSelectedKey();\n  var renderedSelectedIndex = renderedSelectedKey ? linkCollection.keyToIndexMapping[renderedSelectedKey] : 0;\n  var items = linkCollection.links.map(function (l) {\n    return renderPivotLink(linkCollection, l, renderedSelectedKey, classNames.link);\n  }); // The overflow menu starts empty and items[] is updated as the overflow items change\n\n  var overflowMenuProps = React.useMemo(function () {\n    return {\n      items: [],\n      alignTargetEdge: true,\n      directionalHint: DirectionalHint.bottomRightEdge\n    };\n  }, []);\n  var overflowMenuButtonRef = useOverflow({\n    onOverflowItemsChanged: function (overflowIndex, elements) {\n      // Set data-is-overflowing on each item\n      elements.forEach(function (_a) {\n        var ele = _a.ele,\n            isOverflowing = _a.isOverflowing;\n        return ele.dataset.isOverflowing = \"\" + isOverflowing;\n      }); // Update the menu items\n\n      overflowMenuProps.items = linkCollection.links.slice(overflowIndex).filter(function (link) {\n        return link.itemKey !== renderedSelectedKey;\n      }).map(function (link, index) {\n        link.role = 'menuitem';\n        return {\n          key: link.itemKey || \"\" + (overflowIndex + index),\n          onRender: function () {\n            return renderPivotLink(linkCollection, link, renderedSelectedKey, classNames.linkInMenu);\n          }\n        };\n      });\n    },\n    rtl: getRTL(theme),\n    pinnedIndex: renderedSelectedIndex\n  }).menuButtonRef;\n  return React.createElement(\"div\", __assign({\n    ref: ref\n  }, divProps), React.createElement(FocusZone, __assign({\n    componentRef: focusZoneRef,\n    role: \"tablist\"\n  }, nameProps, {\n    direction: FocusZoneDirection.horizontal\n  }, focusZoneProps, {\n    className: css(classNames.root, focusZoneProps === null || focusZoneProps === void 0 ? void 0 : focusZoneProps.className)\n  }), items, overflowBehavior === 'menu' && React.createElement(CommandButton, {\n    className: css(classNames.link, classNames.overflowMenuButton),\n    elementRef: overflowMenuButtonRef,\n    componentRef: overflowMenuButtonComponentRef,\n    menuProps: overflowMenuProps,\n    menuIconProps: {\n      iconName: 'More',\n      style: {\n        color: 'inherit'\n      }\n    },\n    ariaLabel: overflowAriaLabel\n  })), renderedSelectedKey && linkCollection.links.map(function (link) {\n    return (link.alwaysRender === true || renderedSelectedKey === link.itemKey) && renderPivotItem(link.itemKey, renderedSelectedKey === link.itemKey);\n  }));\n});\nPivotBase.displayName = COMPONENT_NAME;","map":{"version":3,"sources":["components/Pivot/Pivot.base.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { useControllableValue, useId } from '@fluentui/react-hooks';\nimport { classNamesFunction, css, divProperties, getNativeProps, getRTL, KeyCodes, warn } from '@fluentui/utilities';\nimport { CommandButton } from '../../Button';\nimport { useOverflow } from '../../utilities/useOverflow';\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\nimport { DirectionalHint } from '../ContextualMenu/ContextualMenu.types';\nimport { Icon } from '../Icon/Icon';\nimport { PivotItem } from './PivotItem';\nimport type { IButton } from '../../Button';\nimport type { IFocusZone } from '../../FocusZone';\nimport type { IContextualMenuProps } from '../ContextualMenu/ContextualMenu.types';\nimport type { IPivot, IPivotProps, IPivotStyleProps, IPivotStyles } from './Pivot.types';\nimport type { IPivotItemProps } from './PivotItem.types';\n\nconst getClassNames = classNamesFunction<IPivotStyleProps, IPivotStyles>();\n\nconst COMPONENT_NAME = 'Pivot';\n\ntype PivotLinkCollection = {\n  links: IPivotItemProps[];\n  keyToIndexMapping: { [key: string]: number };\n  keyToTabIdMapping: { [key: string]: string };\n};\n\nconst getTabId = (props: IPivotProps, pivotId: string, itemKey: string, index: number): string => {\n  if (props.getTabId) {\n    return props.getTabId(itemKey, index);\n  }\n  return pivotId + `-Tab${index}`;\n};\n\n// Gets the set of PivotLinks as array of IPivotItemProps\n// The set of Links is determined by child components of type PivotItem\nconst getLinkItems = (props: IPivotProps, pivotId: string): PivotLinkCollection => {\n  const result: PivotLinkCollection = {\n    links: [],\n    keyToIndexMapping: {},\n    keyToTabIdMapping: {},\n  };\n\n  React.Children.forEach(React.Children.toArray(props.children), (child: React.ReactNode, index: number) => {\n    if (isPivotItem(child)) {\n      // eslint-disable-next-line deprecation/deprecation\n      const { linkText, ...pivotItemProps } = child.props;\n      const itemKey = child.props.itemKey || index.toString();\n      result.links.push({\n        headerText: linkText,\n        ...pivotItemProps,\n        itemKey: itemKey,\n      });\n      result.keyToIndexMapping[itemKey] = index;\n      result.keyToTabIdMapping[itemKey] = getTabId(props, pivotId, itemKey, index);\n    } else if (child) {\n      warn('The children of a Pivot component must be of type PivotItem to be rendered.');\n    }\n  });\n  return result;\n};\n\nconst isPivotItem = (item: React.ReactNode): item is PivotItem => {\n  return React.isValidElement(item) && (item.type as React.ComponentType)?.name === PivotItem.name;\n};\n\nexport const PivotBase: React.FunctionComponent<IPivotProps> = React.forwardRef<HTMLDivElement, IPivotProps>(\n  (props, ref) => {\n    const focusZoneRef = React.useRef<IFocusZone>(null);\n    const overflowMenuButtonComponentRef = React.useRef<IButton>(null);\n    const pivotId: string = useId('Pivot');\n\n    const [selectedKey, setSelectedKey] = useControllableValue(props.selectedKey, props.defaultSelectedKey);\n\n    const { componentRef, theme, linkSize, linkFormat, overflowBehavior, overflowAriaLabel, focusZoneProps } = props;\n\n    let classNames: { [key in keyof IPivotStyles]: string };\n    const nameProps = {\n      'aria-label': props['aria-label'],\n      'aria-labelledby': props['aria-labelledby'],\n    };\n    const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(props, divProperties, [\n      'aria-label',\n      'aria-labelledby',\n    ]);\n\n    let linkCollection = getLinkItems(props, pivotId);\n\n    React.useImperativeHandle(componentRef as React.RefObject<IPivot>, () => ({\n      focus: () => {\n        focusZoneRef.current?.focus();\n      },\n    }));\n\n    const renderLinkContent = (link?: IPivotItemProps): JSX.Element | null => {\n      if (!link) {\n        return null;\n      }\n\n      const { itemCount, itemIcon, headerText } = link;\n      return (\n        <span className={classNames.linkContent}>\n          {itemIcon !== undefined && (\n            <span className={classNames.icon}>\n              <Icon iconName={itemIcon} />\n            </span>\n          )}\n          {headerText !== undefined && <span className={classNames.text}> {link.headerText}</span>}\n          {itemCount !== undefined && <span className={classNames.count}> ({itemCount})</span>}\n        </span>\n      );\n    };\n\n    const renderPivotLink = (\n      renderLinkCollection: PivotLinkCollection,\n      link: IPivotItemProps,\n      renderPivotLinkSelectedKey: string | null | undefined,\n      className: string,\n    ): JSX.Element => {\n      const { itemKey, headerButtonProps, onRenderItemLink } = link;\n      const tabId = renderLinkCollection.keyToTabIdMapping[itemKey!];\n      let linkContent: JSX.Element | null;\n      const isSelected: boolean = renderPivotLinkSelectedKey === itemKey;\n\n      if (onRenderItemLink) {\n        linkContent = onRenderItemLink(link, renderLinkContent);\n      } else {\n        linkContent = renderLinkContent(link);\n      }\n\n      let contentString = link.headerText || '';\n      contentString += link.itemCount ? ' (' + link.itemCount + ')' : '';\n      // Adding space supplementary for icon\n      contentString += link.itemIcon ? ' xx' : '';\n      return (\n        <CommandButton\n          {...headerButtonProps}\n          id={tabId}\n          key={itemKey}\n          className={css(className, isSelected && classNames.linkIsSelected)}\n          // eslint-disable-next-line react/jsx-no-bind\n          onClick={(ev: React.MouseEvent<HTMLElement>) => onLinkClick(itemKey!, ev)}\n          // eslint-disable-next-line react/jsx-no-bind\n          onKeyDown={(ev: React.KeyboardEvent<HTMLElement>) => onKeyDown(itemKey!, ev)}\n          aria-label={link.ariaLabel}\n          role={link.role || 'tab'}\n          aria-selected={isSelected}\n          name={link.headerText}\n          keytipProps={link.keytipProps}\n          data-content={contentString}\n        >\n          {linkContent}\n        </CommandButton>\n      );\n    };\n\n    const onLinkClick = (itemKey: string, ev: React.MouseEvent<HTMLElement>): void => {\n      ev.preventDefault();\n      updateSelectedItem(itemKey, ev);\n    };\n\n    const onKeyDown = (itemKey: string, ev: React.KeyboardEvent<HTMLElement>): void => {\n      // eslint-disable-next-line deprecation/deprecation\n      if (ev.which === KeyCodes.enter) {\n        ev.preventDefault();\n        updateSelectedItem(itemKey);\n      }\n    };\n\n    const updateSelectedItem = (itemKey: string, ev?: React.MouseEvent<HTMLElement>): void => {\n      setSelectedKey(itemKey);\n      linkCollection = getLinkItems(props, pivotId);\n      if (props.onLinkClick && linkCollection.keyToIndexMapping[itemKey] >= 0) {\n        const selectedIndex = linkCollection.keyToIndexMapping[itemKey];\n        const item = React.Children.toArray(props.children)[selectedIndex];\n        if (isPivotItem(item)) {\n          props.onLinkClick(item, ev);\n        }\n      }\n\n      overflowMenuButtonComponentRef.current?.dismissMenu();\n    };\n\n    const renderPivotItem = (itemKey: string | undefined, isActive: boolean): JSX.Element | null => {\n      if (props.headersOnly || !itemKey) {\n        return null;\n      }\n\n      const index = linkCollection.keyToIndexMapping[itemKey];\n      const selectedTabId = linkCollection.keyToTabIdMapping[itemKey];\n      return (\n        <div\n          role=\"tabpanel\"\n          hidden={!isActive}\n          key={itemKey}\n          aria-hidden={!isActive}\n          aria-labelledby={selectedTabId}\n          className={classNames.itemContainer}\n        >\n          {React.Children.toArray(props.children)[index]}\n        </div>\n      );\n    };\n\n    const isKeyValid = (itemKey: string | null | undefined): boolean => {\n      return itemKey === null || (itemKey !== undefined && linkCollection.keyToIndexMapping[itemKey] !== undefined);\n    };\n\n    const getSelectedKey = () => {\n      if (isKeyValid(selectedKey)) {\n        return selectedKey;\n      }\n      if (linkCollection.links.length) {\n        return linkCollection.links[0].itemKey;\n      }\n      return undefined;\n    };\n\n    classNames = getClassNames(props.styles!, {\n      theme: theme!,\n      linkSize,\n      linkFormat,\n    });\n\n    const renderedSelectedKey = getSelectedKey();\n    const renderedSelectedIndex = renderedSelectedKey ? linkCollection.keyToIndexMapping[renderedSelectedKey] : 0;\n\n    const items = linkCollection.links.map(l =>\n      renderPivotLink(linkCollection, l, renderedSelectedKey, classNames.link),\n    );\n\n    // The overflow menu starts empty and items[] is updated as the overflow items change\n    const overflowMenuProps: IContextualMenuProps = React.useMemo(\n      () => ({\n        items: [],\n        alignTargetEdge: true,\n        directionalHint: DirectionalHint.bottomRightEdge,\n      }),\n      [],\n    );\n\n    const { menuButtonRef: overflowMenuButtonRef } = useOverflow({\n      onOverflowItemsChanged: (overflowIndex, elements) => {\n        // Set data-is-overflowing on each item\n        elements.forEach(({ ele, isOverflowing }) => (ele.dataset.isOverflowing = `${isOverflowing}`));\n\n        // Update the menu items\n        overflowMenuProps.items = linkCollection.links\n          .slice(overflowIndex)\n          .filter(link => link.itemKey !== renderedSelectedKey)\n          .map((link, index) => {\n            link.role = 'menuitem';\n\n            return {\n              key: link.itemKey || `${overflowIndex + index}`,\n              onRender: () => renderPivotLink(linkCollection, link, renderedSelectedKey, classNames.linkInMenu),\n            };\n          });\n      },\n      rtl: getRTL(theme),\n      pinnedIndex: renderedSelectedIndex,\n    });\n\n    return (\n      <div ref={ref} {...divProps}>\n        <FocusZone\n          componentRef={focusZoneRef}\n          role=\"tablist\"\n          {...nameProps}\n          direction={FocusZoneDirection.horizontal}\n          {...focusZoneProps}\n          className={css(classNames.root, focusZoneProps?.className)}\n        >\n          {items}\n          {overflowBehavior === 'menu' && (\n            <CommandButton\n              className={css(classNames.link, classNames.overflowMenuButton)}\n              elementRef={overflowMenuButtonRef}\n              componentRef={overflowMenuButtonComponentRef}\n              menuProps={overflowMenuProps}\n              menuIconProps={{ iconName: 'More', style: { color: 'inherit' } }}\n              ariaLabel={overflowAriaLabel}\n            />\n          )}\n        </FocusZone>\n        {renderedSelectedKey &&\n          linkCollection.links.map(\n            link =>\n              (link.alwaysRender === true || renderedSelectedKey === link.itemKey) &&\n              renderPivotItem(link.itemKey, renderedSelectedKey === link.itemKey),\n          )}\n      </div>\n    );\n  },\n);\nPivotBase.displayName = COMPONENT_NAME;\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport * as React from 'react';\nimport { initializeComponentRef, KeyCodes, classNamesFunction, css, styled } from '../../../Utilities';\nimport { CommandButton } from '../../../Button';\nimport { Spinner } from '../../../Spinner';\nimport { Announced } from '../../../Announced';\nimport { SuggestionActionType } from './Suggestions.types';\nimport { SuggestionsItem } from './SuggestionsItem';\nimport { getStyles as suggestionsItemStyles } from './SuggestionsItem.styles';\nimport * as stylesImport from './Suggestions.scss';\nvar legacyStyles = stylesImport;\nvar getClassNames = classNamesFunction();\nvar StyledSuggestionsItem = styled(SuggestionsItem, suggestionsItemStyles, undefined, {\n  scope: 'SuggestionItem'\n});\n/**\n * {@docCategory Pickers}\n */\n\nvar Suggestions =\n/** @class */\nfunction (_super) {\n  __extends(Suggestions, _super);\n\n  function Suggestions(suggestionsProps) {\n    var _this = _super.call(this, suggestionsProps) || this;\n\n    _this._forceResolveButton = React.createRef();\n    _this._searchForMoreButton = React.createRef();\n    _this._selectedElement = React.createRef();\n    _this._scrollContainer = React.createRef();\n    /**\n     * Returns true if the event was handled, false otherwise\n     */\n\n    _this.tryHandleKeyDown = function (keyCode, currentSuggestionIndex) {\n      var isEventHandled = false;\n      var newSelectedActionType = null;\n      var currentSelectedAction = _this.state.selectedActionType;\n      var suggestionLength = _this.props.suggestions.length;\n\n      if (keyCode === KeyCodes.down) {\n        switch (currentSelectedAction) {\n          case SuggestionActionType.forceResolve:\n            if (suggestionLength > 0) {\n              _this._refocusOnSuggestions(keyCode);\n\n              newSelectedActionType = SuggestionActionType.none;\n            } else if (_this._searchForMoreButton.current) {\n              newSelectedActionType = SuggestionActionType.searchMore;\n            } else {\n              newSelectedActionType = SuggestionActionType.forceResolve;\n            }\n\n            break;\n\n          case SuggestionActionType.searchMore:\n            if (_this._forceResolveButton.current) {\n              newSelectedActionType = SuggestionActionType.forceResolve;\n            } else if (suggestionLength > 0) {\n              _this._refocusOnSuggestions(keyCode);\n\n              newSelectedActionType = SuggestionActionType.none;\n            } else {\n              newSelectedActionType = SuggestionActionType.searchMore;\n            }\n\n            break;\n\n          case SuggestionActionType.none:\n            if (currentSuggestionIndex === -1 && _this._forceResolveButton.current) {\n              newSelectedActionType = SuggestionActionType.forceResolve;\n            }\n\n            break;\n        }\n      } else if (keyCode === KeyCodes.up) {\n        switch (currentSelectedAction) {\n          case SuggestionActionType.forceResolve:\n            if (_this._searchForMoreButton.current) {\n              newSelectedActionType = SuggestionActionType.searchMore;\n            } else if (suggestionLength > 0) {\n              _this._refocusOnSuggestions(keyCode);\n\n              newSelectedActionType = SuggestionActionType.none;\n            }\n\n            break;\n\n          case SuggestionActionType.searchMore:\n            if (suggestionLength > 0) {\n              _this._refocusOnSuggestions(keyCode);\n\n              newSelectedActionType = SuggestionActionType.none;\n            } else if (_this._forceResolveButton.current) {\n              newSelectedActionType = SuggestionActionType.forceResolve;\n            }\n\n            break;\n\n          case SuggestionActionType.none:\n            if (currentSuggestionIndex === -1 && _this._searchForMoreButton.current) {\n              newSelectedActionType = SuggestionActionType.searchMore;\n            }\n\n            break;\n        }\n      }\n\n      if (newSelectedActionType !== null) {\n        _this.setState({\n          selectedActionType: newSelectedActionType\n        });\n\n        isEventHandled = true;\n      }\n\n      return isEventHandled;\n    };\n\n    _this._getAlertText = function () {\n      var _a = _this.props,\n          isLoading = _a.isLoading,\n          isSearching = _a.isSearching,\n          suggestions = _a.suggestions,\n          suggestionsAvailableAlertText = _a.suggestionsAvailableAlertText,\n          noResultsFoundText = _a.noResultsFoundText;\n\n      if (!isLoading && !isSearching) {\n        if (suggestions.length > 0) {\n          return suggestionsAvailableAlertText || '';\n        }\n\n        if (noResultsFoundText) {\n          return noResultsFoundText;\n        }\n      }\n\n      return '';\n    };\n\n    _this._getMoreResults = function () {\n      if (_this.props.onGetMoreResults) {\n        _this.props.onGetMoreResults(); // Reset selected action type as it will be of type SuggestionActionType.none after more results are gotten\n\n\n        _this.setState({\n          selectedActionType: SuggestionActionType.none\n        });\n      }\n    };\n\n    _this._forceResolve = function () {\n      if (_this.props.createGenericItem) {\n        _this.props.createGenericItem();\n      }\n    };\n\n    _this._shouldShowForceResolve = function () {\n      return _this.props.showForceResolve ? _this.props.showForceResolve() : false;\n    };\n\n    _this._onClickTypedSuggestionsItem = function (item, index) {\n      return function (ev) {\n        _this.props.onSuggestionClick(ev, item, index);\n      };\n    };\n\n    _this._refocusOnSuggestions = function (keyCode) {\n      if (typeof _this.props.refocusSuggestions === 'function') {\n        _this.props.refocusSuggestions(keyCode);\n      }\n    };\n\n    _this._onRemoveTypedSuggestionsItem = function (item, index) {\n      return function (ev) {\n        var onSuggestionRemove = _this.props.onSuggestionRemove;\n        onSuggestionRemove(ev, item, index);\n        ev.stopPropagation();\n      };\n    };\n\n    initializeComponentRef(_this);\n    _this.state = {\n      selectedActionType: SuggestionActionType.none\n    };\n    return _this;\n  }\n\n  Suggestions.prototype.componentDidMount = function () {\n    this.scrollSelected();\n    this.activeSelectedElement = this._selectedElement ? this._selectedElement.current : null;\n  };\n\n  Suggestions.prototype.componentDidUpdate = function () {\n    // Only scroll to selected element if the selected element has changed. Otherwise do nothing.\n    // This prevents some odd behavior where scrolling the active element out of view and clicking on a selected element\n    // will trigger a focus event and not give the clicked element the click.\n    if (this._selectedElement.current && this.activeSelectedElement !== this._selectedElement.current) {\n      this.scrollSelected();\n      this.activeSelectedElement = this._selectedElement.current;\n    }\n  };\n\n  Suggestions.prototype.render = function () {\n    var _a, _b;\n\n    var _this = this;\n\n    var _c = this.props,\n        forceResolveText = _c.forceResolveText,\n        mostRecentlyUsedHeaderText = _c.mostRecentlyUsedHeaderText,\n        searchForMoreIcon = _c.searchForMoreIcon,\n        searchForMoreText = _c.searchForMoreText,\n        className = _c.className,\n        moreSuggestionsAvailable = _c.moreSuggestionsAvailable,\n        noResultsFoundText = _c.noResultsFoundText,\n        suggestions = _c.suggestions,\n        isLoading = _c.isLoading,\n        isSearching = _c.isSearching,\n        loadingText = _c.loadingText,\n        onRenderNoResultFound = _c.onRenderNoResultFound,\n        searchingText = _c.searchingText,\n        isMostRecentlyUsedVisible = _c.isMostRecentlyUsedVisible,\n        resultsMaximumNumber = _c.resultsMaximumNumber,\n        resultsFooterFull = _c.resultsFooterFull,\n        resultsFooter = _c.resultsFooter,\n        _d = _c.isResultsFooterVisible,\n        isResultsFooterVisible = _d === void 0 ? true : _d,\n        suggestionsHeaderText = _c.suggestionsHeaderText,\n        suggestionsClassName = _c.suggestionsClassName,\n        theme = _c.theme,\n        styles = _c.styles,\n        suggestionsListId = _c.suggestionsListId,\n        suggestionsContainerAriaLabel = _c.suggestionsContainerAriaLabel; // TODO\n    // Clean this up by leaving only the first part after removing support for SASS.\n    // Currently we can not remove the SASS styles from Suggestions class because it\n    // might be used by consumers separately from pickers extending from BasePicker\n    // and have not used the new 'styles' prop. Because it's expecting a type parameter,\n    // we can not use the 'styled' function without adding some helpers which can break\n    // downstream consumers who did not use the new helpers.\n    // We check for 'styles' prop which is going to be injected by the 'styled' HOC\n    // in BasePicker when the typed Suggestions class is ready to be rendered. If the check\n    // passes we can use the CSS-in-JS styles. If the check fails (ex: custom picker),\n    // then we just use the old SASS styles instead.\n\n    this._classNames = styles ? getClassNames(styles, {\n      theme: theme,\n      className: className,\n      suggestionsClassName: suggestionsClassName,\n      forceResolveButtonSelected: this.state.selectedActionType === SuggestionActionType.forceResolve,\n      searchForMoreButtonSelected: this.state.selectedActionType === SuggestionActionType.searchMore\n    }) : {\n      root: css('ms-Suggestions', className, legacyStyles.root),\n      title: css('ms-Suggestions-title', legacyStyles.suggestionsTitle),\n      searchForMoreButton: css('ms-SearchMore-button', legacyStyles.actionButton, (_a = {}, _a['is-selected ' + legacyStyles.buttonSelected] = this.state.selectedActionType === SuggestionActionType.searchMore, _a)),\n      forceResolveButton: css('ms-forceResolve-button', legacyStyles.actionButton, (_b = {}, _b['is-selected ' + legacyStyles.buttonSelected] = this.state.selectedActionType === SuggestionActionType.forceResolve, _b)),\n      suggestionsAvailable: css('ms-Suggestions-suggestionsAvailable', legacyStyles.suggestionsAvailable),\n      suggestionsContainer: css('ms-Suggestions-container', legacyStyles.suggestionsContainer, suggestionsClassName),\n      noSuggestions: css('ms-Suggestions-none', legacyStyles.suggestionsNone)\n    };\n    var spinnerStyles = this._classNames.subComponentStyles ? this._classNames.subComponentStyles.spinner : undefined; // TODO: cleanup after refactor of pickers to composition pattern and remove SASS support.\n\n    var spinnerClassNameOrStyles = styles ? {\n      styles: spinnerStyles\n    } : {\n      className: css('ms-Suggestions-spinner', legacyStyles.suggestionsSpinner)\n    };\n\n    var noResults = function () {\n      return (// This ID can be used by the parent to set aria-activedescendant to this\n        React.createElement(\"div\", {\n          id: \"sug-noResultsFound\",\n          role: \"option\"\n        }, onRenderNoResultFound ? onRenderNoResultFound(undefined, noResults) : React.createElement(\"div\", {\n          className: _this._classNames.noSuggestions\n        }, noResultsFoundText))\n      );\n    }; // MostRecently Used text should supercede the header text if it's there and available.\n\n\n    var headerText = suggestionsHeaderText;\n\n    if (isMostRecentlyUsedVisible && mostRecentlyUsedHeaderText) {\n      headerText = mostRecentlyUsedHeaderText;\n    }\n\n    var footerTitle = undefined;\n\n    if (isResultsFooterVisible) {\n      footerTitle = suggestions.length >= resultsMaximumNumber ? resultsFooterFull : resultsFooter;\n    }\n\n    var hasNoSuggestions = (!suggestions || !suggestions.length) && !isLoading;\n    var forceResolveId = this.state.selectedActionType === SuggestionActionType.forceResolve ? 'sug-selectedAction' : undefined;\n    var searchForMoreId = this.state.selectedActionType === SuggestionActionType.searchMore ? 'sug-selectedAction' : undefined;\n    return React.createElement(\"div\", {\n      className: this._classNames.root,\n      \"aria-label\": suggestionsContainerAriaLabel || headerText,\n      id: suggestionsListId,\n      role: \"listbox\"\n    }, React.createElement(Announced, {\n      message: this._getAlertText(),\n      \"aria-live\": \"polite\"\n    }), headerText ? React.createElement(\"div\", {\n      className: this._classNames.title\n    }, headerText) : null, forceResolveText && this._shouldShowForceResolve() && React.createElement(CommandButton, {\n      componentRef: this._forceResolveButton,\n      className: this._classNames.forceResolveButton,\n      id: forceResolveId,\n      onClick: this._forceResolve,\n      \"data-automationid\": 'sug-forceResolve'\n    }, forceResolveText), isLoading && React.createElement(Spinner, __assign({}, spinnerClassNameOrStyles, {\n      ariaLabel: loadingText,\n      label: loadingText\n    })), hasNoSuggestions ? noResults() : this._renderSuggestions(), searchForMoreText && moreSuggestionsAvailable && React.createElement(CommandButton, {\n      componentRef: this._searchForMoreButton,\n      className: this._classNames.searchForMoreButton,\n      iconProps: searchForMoreIcon || {\n        iconName: 'Search'\n      },\n      id: searchForMoreId,\n      onClick: this._getMoreResults,\n      \"data-automationid\": 'sug-searchForMore',\n      role: 'option'\n    }, searchForMoreText), isSearching ? React.createElement(Spinner, __assign({}, spinnerClassNameOrStyles, {\n      ariaLabel: searchingText,\n      label: searchingText\n    })) : null, footerTitle && !moreSuggestionsAvailable && !isMostRecentlyUsedVisible && !isSearching ? React.createElement(\"div\", {\n      className: this._classNames.title\n    }, footerTitle(this.props)) : null);\n  };\n\n  Suggestions.prototype.hasSuggestedAction = function () {\n    return !!this._searchForMoreButton.current || !!this._forceResolveButton.current;\n  };\n\n  Suggestions.prototype.hasSuggestedActionSelected = function () {\n    return this.state.selectedActionType !== SuggestionActionType.none;\n  };\n\n  Suggestions.prototype.executeSelectedAction = function () {\n    switch (this.state.selectedActionType) {\n      case SuggestionActionType.forceResolve:\n        this._forceResolve();\n\n        break;\n\n      case SuggestionActionType.searchMore:\n        this._getMoreResults();\n\n        break;\n    }\n  };\n\n  Suggestions.prototype.focusAboveSuggestions = function () {\n    if (this._forceResolveButton.current) {\n      this.setState({\n        selectedActionType: SuggestionActionType.forceResolve\n      });\n    } else if (this._searchForMoreButton.current) {\n      this.setState({\n        selectedActionType: SuggestionActionType.searchMore\n      });\n    }\n  };\n\n  Suggestions.prototype.focusBelowSuggestions = function () {\n    if (this._searchForMoreButton.current) {\n      this.setState({\n        selectedActionType: SuggestionActionType.searchMore\n      });\n    } else if (this._forceResolveButton.current) {\n      this.setState({\n        selectedActionType: SuggestionActionType.forceResolve\n      });\n    }\n  };\n\n  Suggestions.prototype.focusSearchForMoreButton = function () {\n    if (this._searchForMoreButton.current) {\n      this._searchForMoreButton.current.focus();\n    }\n  };\n\n  Suggestions.prototype.scrollSelected = function () {\n    if (this._selectedElement.current && this._scrollContainer.current && this._scrollContainer.current.scrollTo !== undefined) {\n      var _a = this._selectedElement.current,\n          offsetHeight = _a.offsetHeight,\n          offsetTop = _a.offsetTop;\n      var _b = this._scrollContainer.current,\n          parentOffsetHeight = _b.offsetHeight,\n          scrollTop = _b.scrollTop;\n      var isAbove = offsetTop < scrollTop;\n      var isBelow = offsetTop + offsetHeight > scrollTop + parentOffsetHeight;\n\n      if (isAbove) {\n        this._scrollContainer.current.scrollTo(0, offsetTop);\n      } else if (isBelow) {\n        this._scrollContainer.current.scrollTo(0, offsetTop - parentOffsetHeight + offsetHeight);\n      }\n    }\n  };\n\n  Suggestions.prototype._renderSuggestions = function () {\n    var _this = this;\n\n    var _a = this.props,\n        onRenderSuggestion = _a.onRenderSuggestion,\n        removeSuggestionAriaLabel = _a.removeSuggestionAriaLabel,\n        suggestionsItemClassName = _a.suggestionsItemClassName,\n        resultsMaximumNumber = _a.resultsMaximumNumber,\n        showRemoveButtons = _a.showRemoveButtons,\n        removeButtonIconProps = _a.removeButtonIconProps;\n    var suggestions = this.props.suggestions;\n    var StyledTypedSuggestionsItem = StyledSuggestionsItem;\n    var selectedIndex = -1;\n    suggestions.some(function (element, index) {\n      if (element.selected) {\n        selectedIndex = index;\n        return true;\n      }\n\n      return false;\n    });\n\n    if (resultsMaximumNumber) {\n      suggestions = selectedIndex >= resultsMaximumNumber ? suggestions.slice(selectedIndex - resultsMaximumNumber + 1, selectedIndex + 1) : suggestions.slice(0, resultsMaximumNumber);\n    }\n\n    if (suggestions.length === 0) {\n      return null;\n    }\n\n    return React.createElement(\"div\", {\n      className: this._classNames.suggestionsContainer,\n      ref: this._scrollContainer,\n      role: \"presentation\"\n    }, suggestions.map(function (suggestion, index) {\n      return React.createElement(\"div\", {\n        ref: suggestion.selected ? _this._selectedElement : undefined,\n        key: suggestion.item.key ? suggestion.item.key : index,\n        role: \"presentation\"\n      }, React.createElement(StyledTypedSuggestionsItem, {\n        suggestionModel: suggestion,\n        RenderSuggestion: onRenderSuggestion,\n        onClick: _this._onClickTypedSuggestionsItem(suggestion.item, index),\n        className: suggestionsItemClassName,\n        showRemoveButton: showRemoveButtons,\n        removeButtonAriaLabel: removeSuggestionAriaLabel,\n        onRemoveItem: _this._onRemoveTypedSuggestionsItem(suggestion.item, index),\n        id: 'sug-' + index,\n        removeButtonIconProps: removeButtonIconProps\n      }));\n    }));\n  };\n\n  return Suggestions;\n}(React.Component);\n\nexport { Suggestions };","map":{"version":3,"sources":["components/pickers/Suggestions/Suggestions.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport { initializeComponentRef, KeyCodes, classNamesFunction, css, styled } from '../../../Utilities';\nimport { CommandButton } from '../../../Button';\nimport { Spinner } from '../../../Spinner';\nimport { Announced } from '../../../Announced';\nimport { SuggestionActionType } from './Suggestions.types';\nimport { SuggestionsItem } from './SuggestionsItem';\nimport { getStyles as suggestionsItemStyles } from './SuggestionsItem.styles';\nimport * as stylesImport from './Suggestions.scss';\nimport type { IStyleFunctionOrObject } from '../../../Utilities';\nimport type { IProcessedStyleSet } from '../../../Styling';\nimport type { IButton } from '../../../Button';\nimport type { ISpinnerStyleProps, ISpinnerStyles } from '../../../Spinner';\nimport type { ISuggestionsProps, ISuggestionsStyleProps, ISuggestionsStyles } from './Suggestions.types';\nimport type { ISuggestionItemProps, ISuggestionsItemStyleProps, ISuggestionsItemStyles } from './SuggestionsItem.types';\n\nconst legacyStyles: any = stylesImport;\n\nconst getClassNames = classNamesFunction<ISuggestionsStyleProps, ISuggestionsStyles>();\n\nexport interface ISuggestionsState {\n  selectedActionType: SuggestionActionType;\n}\n\nconst StyledSuggestionsItem = styled<ISuggestionItemProps<any>, ISuggestionsItemStyleProps, ISuggestionsItemStyles>(\n  SuggestionsItem,\n  suggestionsItemStyles,\n  undefined,\n  {\n    scope: 'SuggestionItem',\n  },\n);\n\n/**\n * {@docCategory Pickers}\n */\nexport class Suggestions<T> extends React.Component<ISuggestionsProps<T>, ISuggestionsState> {\n  protected _forceResolveButton = React.createRef<IButton>();\n  protected _searchForMoreButton = React.createRef<IButton>();\n  protected _selectedElement = React.createRef<HTMLDivElement>();\n  protected _scrollContainer = React.createRef<HTMLDivElement>();\n  private activeSelectedElement: HTMLDivElement | null;\n  private _classNames: Partial<IProcessedStyleSet<ISuggestionsStyles>>;\n\n  constructor(suggestionsProps: ISuggestionsProps<T>) {\n    super(suggestionsProps);\n\n    initializeComponentRef(this);\n\n    this.state = {\n      selectedActionType: SuggestionActionType.none,\n    };\n  }\n\n  public componentDidMount(): void {\n    this.scrollSelected();\n    this.activeSelectedElement = this._selectedElement ? this._selectedElement.current : null;\n  }\n\n  public componentDidUpdate(): void {\n    // Only scroll to selected element if the selected element has changed. Otherwise do nothing.\n    // This prevents some odd behavior where scrolling the active element out of view and clicking on a selected element\n    // will trigger a focus event and not give the clicked element the click.\n    if (this._selectedElement.current && this.activeSelectedElement !== this._selectedElement.current) {\n      this.scrollSelected();\n      this.activeSelectedElement = this._selectedElement.current;\n    }\n  }\n\n  public render(): JSX.Element {\n    const {\n      forceResolveText,\n      mostRecentlyUsedHeaderText,\n      searchForMoreIcon,\n      searchForMoreText,\n      className,\n      moreSuggestionsAvailable,\n      noResultsFoundText,\n      suggestions,\n      isLoading,\n      isSearching,\n      loadingText,\n      onRenderNoResultFound,\n      searchingText,\n      isMostRecentlyUsedVisible,\n      resultsMaximumNumber,\n      resultsFooterFull,\n      resultsFooter,\n      isResultsFooterVisible = true,\n      suggestionsHeaderText,\n      suggestionsClassName,\n      theme,\n      styles,\n      suggestionsListId,\n      suggestionsContainerAriaLabel,\n    } = this.props;\n\n    // TODO\n    // Clean this up by leaving only the first part after removing support for SASS.\n    // Currently we can not remove the SASS styles from Suggestions class because it\n    // might be used by consumers separately from pickers extending from BasePicker\n    // and have not used the new 'styles' prop. Because it's expecting a type parameter,\n    // we can not use the 'styled' function without adding some helpers which can break\n    // downstream consumers who did not use the new helpers.\n    // We check for 'styles' prop which is going to be injected by the 'styled' HOC\n    // in BasePicker when the typed Suggestions class is ready to be rendered. If the check\n    // passes we can use the CSS-in-JS styles. If the check fails (ex: custom picker),\n    // then we just use the old SASS styles instead.\n    this._classNames = styles\n      ? getClassNames(styles, {\n          theme: theme!,\n          className,\n          suggestionsClassName,\n          forceResolveButtonSelected: this.state.selectedActionType === SuggestionActionType.forceResolve,\n          searchForMoreButtonSelected: this.state.selectedActionType === SuggestionActionType.searchMore,\n        })\n      : {\n          root: css('ms-Suggestions', className, legacyStyles.root),\n          title: css('ms-Suggestions-title', legacyStyles.suggestionsTitle),\n          searchForMoreButton: css('ms-SearchMore-button', legacyStyles.actionButton, {\n            ['is-selected ' + legacyStyles.buttonSelected]:\n              this.state.selectedActionType === SuggestionActionType.searchMore,\n          }),\n          forceResolveButton: css('ms-forceResolve-button', legacyStyles.actionButton, {\n            ['is-selected ' + legacyStyles.buttonSelected]:\n              this.state.selectedActionType === SuggestionActionType.forceResolve,\n          }),\n          suggestionsAvailable: css('ms-Suggestions-suggestionsAvailable', legacyStyles.suggestionsAvailable),\n          suggestionsContainer: css(\n            'ms-Suggestions-container',\n            legacyStyles.suggestionsContainer,\n            suggestionsClassName,\n          ),\n          noSuggestions: css('ms-Suggestions-none', legacyStyles.suggestionsNone),\n        };\n\n    const spinnerStyles = this._classNames.subComponentStyles\n      ? (this._classNames.subComponentStyles.spinner as IStyleFunctionOrObject<ISpinnerStyleProps, ISpinnerStyles>)\n      : undefined;\n\n    // TODO: cleanup after refactor of pickers to composition pattern and remove SASS support.\n    const spinnerClassNameOrStyles = styles\n      ? { styles: spinnerStyles }\n      : {\n          className: css('ms-Suggestions-spinner', legacyStyles.suggestionsSpinner),\n        };\n\n    const noResults = () => (\n      // This ID can be used by the parent to set aria-activedescendant to this\n      <div id=\"sug-noResultsFound\" role=\"option\">\n        {onRenderNoResultFound ? (\n          onRenderNoResultFound(undefined, noResults)\n        ) : (\n          <div className={this._classNames.noSuggestions}>{noResultsFoundText}</div>\n        )}\n      </div>\n    );\n\n    // MostRecently Used text should supercede the header text if it's there and available.\n    let headerText: string | undefined = suggestionsHeaderText;\n    if (isMostRecentlyUsedVisible && mostRecentlyUsedHeaderText) {\n      headerText = mostRecentlyUsedHeaderText;\n    }\n\n    let footerTitle: ((props: ISuggestionsProps<T>) => JSX.Element) | undefined = undefined;\n    if (isResultsFooterVisible) {\n      footerTitle = suggestions.length >= (resultsMaximumNumber as number) ? resultsFooterFull : resultsFooter;\n    }\n\n    const hasNoSuggestions = (!suggestions || !suggestions.length) && !isLoading;\n\n    const forceResolveId =\n      this.state.selectedActionType === SuggestionActionType.forceResolve ? 'sug-selectedAction' : undefined;\n    const searchForMoreId =\n      this.state.selectedActionType === SuggestionActionType.searchMore ? 'sug-selectedAction' : undefined;\n\n    return (\n      <div\n        className={this._classNames.root}\n        aria-label={suggestionsContainerAriaLabel || headerText}\n        id={suggestionsListId}\n        role=\"listbox\"\n      >\n        <Announced message={this._getAlertText()} aria-live=\"polite\" />\n\n        {headerText ? <div className={this._classNames.title}>{headerText}</div> : null}\n        {forceResolveText && this._shouldShowForceResolve() && (\n          <CommandButton\n            componentRef={this._forceResolveButton}\n            className={this._classNames.forceResolveButton}\n            id={forceResolveId}\n            onClick={this._forceResolve}\n            data-automationid={'sug-forceResolve'}\n          >\n            {forceResolveText}\n          </CommandButton>\n        )}\n        {isLoading && <Spinner {...spinnerClassNameOrStyles} ariaLabel={loadingText} label={loadingText} />}\n        {hasNoSuggestions ? noResults() : this._renderSuggestions()}\n        {searchForMoreText && moreSuggestionsAvailable && (\n          <CommandButton\n            componentRef={this._searchForMoreButton}\n            className={this._classNames.searchForMoreButton}\n            iconProps={searchForMoreIcon || { iconName: 'Search' }}\n            id={searchForMoreId}\n            onClick={this._getMoreResults}\n            data-automationid={'sug-searchForMore'}\n            role={'option'}\n          >\n            {searchForMoreText}\n          </CommandButton>\n        )}\n        {isSearching ? <Spinner {...spinnerClassNameOrStyles} ariaLabel={searchingText} label={searchingText} /> : null}\n        {footerTitle && !moreSuggestionsAvailable && !isMostRecentlyUsedVisible && !isSearching ? (\n          <div className={this._classNames.title}>{footerTitle(this.props)}</div>\n        ) : null}\n      </div>\n    );\n  }\n\n  /**\n   * Returns true if the event was handled, false otherwise\n   */\n  public tryHandleKeyDown = (keyCode: number, currentSuggestionIndex: number): boolean => {\n    let isEventHandled = false;\n    let newSelectedActionType = null;\n    const currentSelectedAction = this.state.selectedActionType;\n    const suggestionLength = this.props.suggestions.length;\n    if (keyCode === KeyCodes.down) {\n      switch (currentSelectedAction) {\n        case SuggestionActionType.forceResolve:\n          if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          } else if (this._searchForMoreButton.current) {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          } else {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          }\n          break;\n        case SuggestionActionType.searchMore:\n          if (this._forceResolveButton.current) {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          } else if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          } else {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          }\n          break;\n        case SuggestionActionType.none:\n          if (currentSuggestionIndex === -1 && this._forceResolveButton.current) {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          }\n          break;\n      }\n    } else if (keyCode === KeyCodes.up) {\n      switch (currentSelectedAction) {\n        case SuggestionActionType.forceResolve:\n          if (this._searchForMoreButton.current) {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          } else if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          }\n          break;\n        case SuggestionActionType.searchMore:\n          if (suggestionLength > 0) {\n            this._refocusOnSuggestions(keyCode);\n            newSelectedActionType = SuggestionActionType.none;\n          } else if (this._forceResolveButton.current) {\n            newSelectedActionType = SuggestionActionType.forceResolve;\n          }\n          break;\n        case SuggestionActionType.none:\n          if (currentSuggestionIndex === -1 && this._searchForMoreButton.current) {\n            newSelectedActionType = SuggestionActionType.searchMore;\n          }\n          break;\n      }\n    }\n\n    if (newSelectedActionType !== null) {\n      this.setState({ selectedActionType: newSelectedActionType });\n      isEventHandled = true;\n    }\n\n    return isEventHandled;\n  };\n\n  public hasSuggestedAction(): boolean {\n    return !!this._searchForMoreButton.current || !!this._forceResolveButton.current;\n  }\n\n  public hasSuggestedActionSelected(): boolean {\n    return this.state.selectedActionType !== SuggestionActionType.none;\n  }\n\n  public executeSelectedAction(): void {\n    switch (this.state.selectedActionType) {\n      case SuggestionActionType.forceResolve:\n        this._forceResolve();\n        break;\n      case SuggestionActionType.searchMore:\n        this._getMoreResults();\n        break;\n    }\n  }\n\n  public focusAboveSuggestions(): void {\n    if (this._forceResolveButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.forceResolve });\n    } else if (this._searchForMoreButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.searchMore });\n    }\n  }\n\n  public focusBelowSuggestions(): void {\n    if (this._searchForMoreButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.searchMore });\n    } else if (this._forceResolveButton.current) {\n      this.setState({ selectedActionType: SuggestionActionType.forceResolve });\n    }\n  }\n\n  public focusSearchForMoreButton(): void {\n    if (this._searchForMoreButton.current) {\n      this._searchForMoreButton.current.focus();\n    }\n  }\n\n  public scrollSelected(): void {\n    if (\n      this._selectedElement.current &&\n      this._scrollContainer.current &&\n      this._scrollContainer.current.scrollTo !== undefined\n    ) {\n      const { offsetHeight, offsetTop } = this._selectedElement.current;\n      const { offsetHeight: parentOffsetHeight, scrollTop } = this._scrollContainer.current;\n\n      const isAbove = offsetTop < scrollTop;\n      const isBelow = offsetTop + offsetHeight > scrollTop + parentOffsetHeight;\n\n      if (isAbove) {\n        this._scrollContainer.current.scrollTo(0, offsetTop);\n      } else if (isBelow) {\n        this._scrollContainer.current.scrollTo(0, offsetTop - parentOffsetHeight + offsetHeight);\n      }\n    }\n  }\n\n  private _getAlertText = () => {\n    const { isLoading, isSearching, suggestions, suggestionsAvailableAlertText, noResultsFoundText } = this.props;\n    if (!isLoading && !isSearching) {\n      if (suggestions.length > 0) {\n        return suggestionsAvailableAlertText || '';\n      }\n      if (noResultsFoundText) {\n        return noResultsFoundText;\n      }\n    }\n    return '';\n  };\n\n  private _renderSuggestions(): JSX.Element | null {\n    const {\n      onRenderSuggestion,\n      removeSuggestionAriaLabel,\n      suggestionsItemClassName,\n      resultsMaximumNumber,\n      showRemoveButtons,\n      removeButtonIconProps,\n    } = this.props;\n\n    let { suggestions } = this.props;\n\n    const StyledTypedSuggestionsItem: React.FunctionComponent<ISuggestionItemProps<T>> = StyledSuggestionsItem;\n\n    let selectedIndex = -1;\n    suggestions.some((element, index) => {\n      if (element.selected) {\n        selectedIndex = index;\n        return true;\n      }\n      return false;\n    });\n\n    if (resultsMaximumNumber) {\n      suggestions =\n        selectedIndex >= resultsMaximumNumber\n          ? suggestions.slice(selectedIndex - resultsMaximumNumber + 1, selectedIndex + 1)\n          : suggestions.slice(0, resultsMaximumNumber);\n    }\n\n    if (suggestions.length === 0) {\n      return null;\n    }\n\n    return (\n      <div className={this._classNames.suggestionsContainer} ref={this._scrollContainer} role=\"presentation\">\n        {suggestions.map((suggestion, index) => (\n          <div\n            ref={suggestion.selected ? this._selectedElement : undefined}\n            key={(suggestion.item as any).key ? (suggestion.item as any).key : index}\n            role=\"presentation\"\n          >\n            <StyledTypedSuggestionsItem\n              suggestionModel={suggestion}\n              RenderSuggestion={onRenderSuggestion}\n              onClick={this._onClickTypedSuggestionsItem(suggestion.item, index)}\n              className={suggestionsItemClassName}\n              showRemoveButton={showRemoveButtons}\n              removeButtonAriaLabel={removeSuggestionAriaLabel}\n              onRemoveItem={this._onRemoveTypedSuggestionsItem(suggestion.item, index)}\n              id={'sug-' + index}\n              removeButtonIconProps={removeButtonIconProps}\n            />\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  private _getMoreResults = (): void => {\n    if (this.props.onGetMoreResults) {\n      this.props.onGetMoreResults();\n\n      // Reset selected action type as it will be of type SuggestionActionType.none after more results are gotten\n      this.setState({ selectedActionType: SuggestionActionType.none });\n    }\n  };\n\n  private _forceResolve = (): void => {\n    if (this.props.createGenericItem) {\n      this.props.createGenericItem();\n    }\n  };\n\n  private _shouldShowForceResolve = (): boolean => {\n    return this.props.showForceResolve ? this.props.showForceResolve() : false;\n  };\n\n  private _onClickTypedSuggestionsItem = (item: T, index: number): ((ev: React.MouseEvent<HTMLElement>) => void) => {\n    return (ev: React.MouseEvent<HTMLElement>): void => {\n      this.props.onSuggestionClick(ev, item, index);\n    };\n  };\n\n  private _refocusOnSuggestions = (keyCode: number): void => {\n    if (typeof this.props.refocusSuggestions === 'function') {\n      this.props.refocusSuggestions(keyCode);\n    }\n  };\n\n  private _onRemoveTypedSuggestionsItem = (item: T, index: number): ((ev: React.MouseEvent<HTMLElement>) => void) => {\n    return (ev: React.MouseEvent<HTMLElement>): void => {\n      const onSuggestionRemove = this.props.onSuggestionRemove!;\n      onSuggestionRemove(ev, item, index);\n      ev.stopPropagation();\n    };\n  };\n}\n"],"sourceRoot":"../src/"},"metadata":{},"sourceType":"module"}